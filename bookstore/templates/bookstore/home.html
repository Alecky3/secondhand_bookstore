<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block maintitle %} Home {% endblock maintitle %}</title>
    {% block styles %}
    {% load static %}
    <link rel="stylesheet" href="{%  static '/bookstore/main12.css' %}">
    {% load static %}
    <link rel="icon" type="image/png" href="{% static '/bookstore/images/ccloud.png' %}">
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static '/bookstore/bootstrap-5/css/bootstrap.min.css' %}">
    
    {% load static %}
    <script src="{% static '/bookstore/bootstrap-5/js/bootstrap.min.js' %}"></script>
    {% load static %}
    <script src="{% static '/bookstore/popper.js' %}"></script>

    {% load static %}
    <link rel="stylesheet" href="{%  static '/bookstore/fontawesome/css/all.css' %}">
    {% load static %}
    <script src="{% static '/bookstore/jquery-3.6.0.js' %}"></script>
    {% load static %}
    <link rel="stylesheet" href="{% static '/bookstore/datatables.css' %}">
    {% load static %}
    <link rel="stylesheet" href="{% static '/bookstore/bootstrap.css' %}">
    {% load static %}
    <link rel="stylesheet" href="{% static '/bookstore/jquery.dataTables.min.css' %}">
    {% load static %}
    <script src="{% static '/bookstore/datatables.js' %}"></script>
    {% endblock styles %}
</head>
<body class="position-relative">
     <!--Start of Cart-->
     <div id="cart" class="lert bg-light  fade show position-fixed border border-light top-0 end-0 p-3 rounded d-none" style="min-width: 50%;max-width: 80%;max-height: 100vh; overflow-y: scroll;z-index: 100000;">
        <div class="cart-title lead py-2 border-bottom border-dark border-2">Your Selected Books</div>
        <div class="cart-container d-flex flex-column p-2">
 
        </div>
        <div class="totals-container d-flex py-2 border-top border-dark border-2">
            <span class="lead fw-80 me-3">Totals</span>
            <input type="text" class="form-control" disabled value="0" id="cartTotals">
        </div>
        <div class="ckeckout-container py-3">
            <ul class="nav nav-tabs  justify-content-between align-items-center" role="tablist">
                <li class="nav-item" role="presentation"><a href="#" class="nav-link bg-success text-dark">CheckOut</a></li>
                <li class="nav-item" ><a href="#" class="nav-link  bg-danger text-dark">Close</a></li>
            </ul>
        </div>
       <button type="button" class="btn-close position-absolute top-0 end-0 me-2" id="cartCloseBtn" role="alert" data-bs-dismis="alert" data-bs-target="#alertlast" arial-label="Close"></button>
   </div>
    <!--End of Cart-->
    {% block main-nav %}
    <nav class="main-nav navbar navbar-expand-md navbar-light bg-white sticky-top border border-bottom-1 border-light">
        <div class="container-fluid">
              <a href="#" class="navbar-brand"><img src="{% static '/bookstore/images/ccloud.png' %}" alt="" width="30" height="30">BookStore</a>
              <form action="" class="d-flex flex-grow-1 me-3">
                <input type="text" class="form-control flex-grow-1">
                <button class="btn btn-small btn-light border border-1 rounded-end">Search</button>
              </form>
              <button role="button" class="navbar-toggler mx-2" data-bs-toggle="collapse" data-bs-target="#mainvav-collapse">
                  <span class="navbar-toggler-icon"></span>
              </button>

              <div class="collapse navbar-collapse" id="mainvav-collapse">
                     <div class="navbar-nav" style="width:100%">
                         <ul class="navbar-nav " style="width: 100%;">
                             <li class="nav-item "><a href="{% url 'bookstore:home'%}" class="nav-link">Home</a></li>
                             <li class="nav-item "><a href="" class="nav-link">Publishers</a>
                               
                            </li>
                             <li class="nav-item "><a href="" class="nav-link">Authors</a></li>
                             <li class="nav-item cart"><a href="" class="nav-link d-flex" id="cart-toggler"><i class="fas fa-cart-plus"></i> Cart <div id="cart_count" style="transform: translateY(-10px);color: tomato;">0</div></a></li>
                             <li class="nav-item signup me-2"><a href="{% url 'bookstore:signup' %}" class="nav-link rounded"><i class="fas fa-user"></i> Sign Up</a></li>
                             <li class="nav-item  login"><a href="{% url 'bookstore:login'%}" class="nav-link rounded"><i class="fas fa-lock-open"></i> Login</a></li>
                         </ul>
                     </div>
              </div>
        </div>
    </nav>
    {% endblock main-nav %}
    <!--end of main navigation-->
    {% block main %}
    {% block main-slider %}
    <div class="carousel slide main-slider" data-bs-ride="carousel" id="main-slider">
        
        <div class="carousel-indicators">
            {% for slider_img in mainslider_images %}
            {% if forloop.first %}
            <button type="button" data-bs-target="#main-slider" data-bs-slide-to="{{forloop.counter0}}" class="active"></button>
            {% else %}
            <button type="button" data-bs-target="#main-slider" data-bs-slide-to="{{forloop.counter0}}"></button>
            {% endif %}
            {% endfor %}
        </div>
       
        <div class="carousel-inner">
            {% for slider_img in mainslider_images %}
              {% if forloop.first %}
            <div class="carousel-item active">
                <img src="{{slider_img.image.url}}" alt="" class=" d-block w-100">
            </div>
             {% else %}
             <div class="carousel-item ">
                <img src="{{slider_img.image.url}}" alt="" class=" d-block w-100">
            </div>
              {% endif %}
           
            {% endfor %}
        </div>
        <button role="button" class="carousel-control-prev" data-bs-target="#main-slider" data-bs-slide="prev">
            <span class="carousel-control-prev-icon bg-success rounded-pill p-2"></span>
        </button>
        <button role="button" class="carousel-control-next" data-bs-target="#main-slider" data-bs-slide="next">
            <span class="carousel-control-next-icon bg-success rounded-pill p-2"></span>
        </button>
    </div>
    {% endblock main-slider %}
    <!--end of main slider-->
    
    <!--start of main content-->
    {% block main-content%}
    <div class="main-content">
        {% block main-content-left %}
        <div class="main-content-left">
            <div class="navbar navbar-expand-sm navbar-light bg-white align-items-start"  style="height: 100%;">
                <div class="container-fluid ">
                    <button class="navbar-toggler">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                   <div class="collapse navbar-collapse flex-column" id="main-content-left-collapse">
                       
                          
                          <h5>Categories</h5>
                          
                          <ul class="navbar-nav flex-column" style="width: 100%;">
                            {% for category in categories %}
                              <li class="nav-item">
                                  <div class="d-flex align-items-center">
                                      <a class="fas fa-chevron-circle-right nav-link" data-bs-toggle="collapse" role="button" href="#{{category}}" arial-expanded="false"></i>
                                      <a href="{% url 'bookstore:categories' category.pk %}" class="nav-link">{{category.name}}</a>
                                  </div>
                                  <div class="collapse ms-2" id="{{category}}">
                                      <ul class="navbar-nav flex-column category-dropdown">
                                         {% for subcategory in category.subcategory_set.all %}
                                           <li class="nav-item ps-2"><a href="{% url 'bookstore:subcategories' subcategory.pk %}" class="nav-link">{{subcategory.name}}</a></li>
                                         {% endfor %}
                                      </ul>
                                  </div>
                              </li>
                              {% endfor %}
                          </ul>
                          
                   </div>
                </div>
            </div>

        </div>
        {% endblock main-content-left%}

        {% block main-content-right %}
        <div class="main-content-right">
            {% for category in categories %}
              {% if category.book_set.count > 0 %}
            <div class="category position-relative">

               <h2 class="h6 ms-4">{{category.name}}</h2>
               <div class="books-container position-relative">
                   <div class="scroll-left position-absolute top-50 rounded-pill d-flex justify-content-center align-items-center shadow-lg" style="width: 40px;height: 40px;z-index: 10;background-color: #adb5bd; box-shadow: 0.25rem 0.25rem 0.25rem #dee2e6 ,-0.155rem -0.25rem 0.25rem #dee2e6!important;"><i class="fas fa-chevron-left fs-6 text-light"></i></div>
                   <div class="scroll-right position-absolute top-50 start-100 rounded-pill d-flex justify-content-center align-items-center shadow-lg " style="width: 40px;height: 40px;z-index: 10; transform: translateX(-40px);background-color: #adb5bd; box-shadow: 0.25rem 0.25rem 0.25rem #dee2e6 ,-0.155rem -0.25rem 0.25rem #dee2e6!important;"><i class="fas fa-chevron-right text-light"></i></div>
                     {% for book in category.book_set.all %}
                     {% if book.price > 0.00 %}
                   <div class="book bg-light rounded" data-id="{{book.pk}}" data-free="false">
                       {% else %}
                       <div class="book bg-light rounded" data-id="{{book.pk}}" data-free="true">
                        {% endif %}
                       <div class="book-img-container">
                           <img src="{{book.image.url}}" alt="" class="img"><span>
                       </div>
                       <div class="book-details bg-white p-2 d-flex flex-column">
                           <h5 class="book-title fs-6 flex-grow-1 mt-auto text-nowrap" style="color: #252627;overflow: hidden;">{{book.title}}</h5>
                           <h5 class="fs-6">Price: <span>{{book.price}}</span></h5>
                           <div><a href="{% url 'bookstore:bookdetails' book.id%}" class="">View Details</a></div>
                        
                       </div>
                   </div>
                   {% endfor %}
               </div>
           </div>
             {% endif %}
           {% endfor %}
        </div>
        {% endblock main-content-right %}
    </div>
   {% endblock main-content %}
   {% endblock main %}
    <!--end of main content-->
    {% block main-footer %}
    <footer class="main-footer">
        <div class="footer-top">
            <div class="footer-top-left">
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="">Publishers</a></li>
                    <li><a href="">Our Offices</a></li>
                    <li><a href="">Developer</a></li>
                    
                </ul>
            </div>
            <div class="footer-top-center">
                     <ul>
                        <li><a href="">Support</a></li>
                        <li><a href="">Contact us</a></li>
                        <li><a href="">Our Location</a></li>
                     </ul>
            </div>
            <div class="footer-top-right">
                <ul>
                    <li><i class="fab fa-facebook"></i><a href="">Facebook</a></li>
                    <li><i class="fab fa-twitter"></i><a href="">Twitter</a></li>
                    <li><i class="fab fa-instagram"></i><a href="">Instagram</a></li>
                    <li><i class="fab fa-whatsapp"></i><a href="">Whatsapp</a></li>
                    <li><i class="fab fa-linkedin"></i><a href="">Linkedin</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <span>&copy; Copyright 2021</span>
        </div>
    </footer>

    {% endblock main-footer %}
    {% block js-main%}
    <script>
       var i= document.querySelectorAll(".main-content-left i")
       i.forEach(elem=>{
        elem.addEventListener('click',function(e){
            if(e.target.classList.contains('show')){
                e.target.classList.remove("show")
                e.target.parentNode.nextElementSibling.classList.remove("dropdown-show")
            }else{
                e.target.classList.add("show")
                e.target.parentNode.nextElementSibling.classList.add("dropdown-show")
            }
            
        })
       });
       document.querySelectorAll(".book-img-container").forEach(elem=>{
             elem.style.background=`rgba(${Math.random()*255},${Math.random()*255},${Math.random()*255},${Math.random()+0.1})`
       })
    //    document.querySelectorAll(".book-details").forEach(elem=>{
    //     elem.style.background=`linear-gradient(rgba(${Math.random()*255},${Math.random()*255},${Math.random()*255},0.3),
    //     rgba(${Math.random()*255},${Math.random()*255},${Math.random()*255},${Math.random()+0.1}))
    //     `
    //    });
       var showpassword=document.getElementById("showpassword");
       if(showpassword){
         showpassword.addEventListener('click',function(e){
         if(e.target.classList.contains("fa-eye")){
             e.target.classList.remove("fa-eye")
             e.target.classList.add("fa-eye-slash")
             var pfield=document.getElementById("passwordfield");
             pfield.setAttribute("type","password")
         }else{
            e.target.classList.remove("fa-eye-slash")
             e.target.classList.add("fa-eye")
             var pfield=document.getElementById("passwordfield");
             pfield.setAttribute("type","text")
         }
       });
    }
      var errorMsg=document.getElementById("login-error");
      if(errorMsg){
        errorMsg.addEventListener('click',function(e){
          var errorContainer=document.getElementById("login-error-container")
          if(errorContainer.classList.contains("show")){
              errorContainer.classList.remove("show")
              errorContainer.classList.add("hide")
          }
       });
    }
      var salutation=document.getElementById("id_salutation");
      if(salutation){
        salutation.classList.add("form-select","p-2","my-3","flex-fill")
      }

      var gender=document.getElementById("id_gender");
      if(salutation){
        gender.classList.add("form-select","p-2","my-3","flex-fill")
      }

      var mycustom_alert=document.getElementById("cart");
        var toggleCustom=document.getElementById("cart-toggler")
        toggleCustom.addEventListener("click",function(){
            event.preventDefault();
            var cartContainer=document.querySelector("#cart .cart-container");
            console.log(cartContainer);
            if(cartContainer.children.length > 0)
               $(mycustom_alert).toggleClass("d-none");
            
            
        })
        var lastBtn=document.getElementById("cartCloseBtn")
        lastBtn.addEventListener('click',function(){
        //    console.log("clicked");
           $(mycustom_alert).toggleClass("d-none");
        })
     
    </script>
    {%block js-other%}
    {% endblock js-other%}
     {% endblock js-main%}
</body>
</html>